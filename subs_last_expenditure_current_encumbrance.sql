SELECT current_year.title saw_0, current_year.fund saw_1, current_year.payment_status saw_2, current_year.pol_num saw_3, current_year.vendor_code saw_4, current_year.renewal_date saw_5, current_year.encumbrance saw_6, current_year.expenditure saw_7, last_year_exp.prev_expenditure saw_8 FROM (SELECT "Funds Expenditure"."Fiscal Period"."Fiscal Period Description" saw_1, "Funds Expenditure"."PO Line"."PO Line Reference" saw_2, "Funds Expenditure"."Transaction Date"."Transaction Date" saw_3, SUM("Funds Expenditure"."Fund Transactions"."Transaction Expenditure Amount" BY "PO Line"."PO Line Reference") prev_expenditure, TOPN("Funds Expenditure"."Transaction Date"."Transaction Date",1 BY "Funds Expenditure"."PO Line"."PO Line Reference") saw_5 FROM "Funds Expenditure" WHERE "Fiscal Period"."Fiscal Period Description" = 'FY-2018') last_year_exp LEFT JOIN (SELECT "Funds Expenditure"."Bibliographic Details"."Title" title, "Funds Expenditure"."Fund Ledger"."Fund Ledger Name" fund, "Funds Expenditure"."PO Line"."Status" pol_status,"Funds Expenditure"."Invoice Line"."Invoice-Payment Status" payment_status, "Funds Expenditure"."PO Line"."PO Line Reference" pol_num, "Funds Expenditure"."PO Line"."Renewal Date" renewal_date, "Funds Expenditure"."Vendor"."Vendor Code" vendor_code, "Funds Expenditure"."Fund Transactions"."Transaction Encumbrance Amount" encumbrance, "Funds Expenditure"."Fund Transactions"."Transaction Expenditure Amount" expenditure FROM "Funds Expenditure" WHERE (("Fiscal Period"."Fiscal Period Description" = 'FY-2019') AND ("PO Line Type"."Continuity" = 'CONTINUOUS') AND ("Fund Ledger"."Fund Type" = 'Allocated fund') AND (("Fund Transactions"."Transaction Encumbrance Amount" <> 0) OR ("Fund Transactions"."Transaction Expenditure Amount" <> 0)))) current_year ON last_year_exp.saw_2 = current_year.pol_num